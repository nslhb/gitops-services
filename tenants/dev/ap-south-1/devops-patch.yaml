apiVersion: kustomize.toolkit.fluxcd.io/v1beta1
kind: Kustomization
metadata:
  name: kube-system
  namespace: flux-system
spec:
  images:
    - name: public.ecr.aws/bitnami/cluster-autoscaler
      newName: k8s.gcr.io/autoscaling/cluster-autoscaler-arm64
      newTag: v1.20.0
  postBuild:
    substitute:
      cluster_region: "ap-south-1"
      account_id: "755502957828"
      cluster_name: "dev"
---
apiVersion: kustomize.toolkit.fluxcd.io/v1beta1
kind: Kustomization
metadata:
  name: monitoring
  namespace: flux-system
spec:
  patchesJson6902:
    - target:
        version: v2beta1
        kind: HelmRelease
        name: prometheus-adapter
      patch:
        - op: replace
          path: /spec/values/image/repository
          value: "directxman12/k8s-prometheus-adapter-arm64"